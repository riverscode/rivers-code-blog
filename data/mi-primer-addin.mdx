---
title: "Mi primer addin con la API de Revit"
publishedAt: "2021-12-26"
summary: "Conoceremos como crear nuestro primer addin con la API de Revit."
tags:
  - 'üíª Desarrollo'
  - 'Revit API'
---

La tecnologia esta cambiando los habitos de las personas, desde mantenerlas informardas hasta volverlas mas exigentes, lo cual aporta en realizaci√≥n personal y laboral de cada persona, de tal manera que nos reinventemos para ofrecer buenas experiencias, responder a la demanda laboral, reducir costos, automatizar procesos, aumentar ingresos, etc. Es por ello que en este Post tratamos de compartir un granito de conocimiento de como ingresar al mundo de la API en Revit.

### Proyecto: HelloWorld

El aplicativo que crearemos mostrara un peque√±o mensaje en el software de Revit.

Empezaremos creando un proyecto con la opci√≥n de **_Crear un Proyecto_** en el software de Visual Studio. La version usada es la version 2019, pero el interfaz para las otras versiones no varia de manera importante.

![1.jpg](/images/posts/mi-primer-addin/1.jpg)

Crearemos una [librer√≠a de clases (.dll)](https://docs.microsoft.com/es-es/dotnet/standard/class-libraries) del cual encontraremos dos tipos en Visual Studio 2019, el .NET Framework con C# y .NET Framework con VB.

```
| Lenguaje        |                Caracteristicas                  |
| _______________ | ___________________________________             |
| Con C#          | Existe mayor documentaci√≥n para desarrolladores |
| Con VB          | La cantidad de documentaci√≥n es limitada.       |
```

![2.jpg](/images/posts/mi-primer-addin/2.jpg)

Para nuestro proyecto usaremos el .NET Framework con C#.

Luego definiremos el **nombre de la soluci√≥n** y **nombre de proyecto** del aplicativo que procederemos a crear. Hay que entender la diferencia del nombre del proyecto y el nombre de la soluci√≥n.

- **Nombre de la Soluci√≥n** Es la soluci√≥n a un problema general que puede englobar varios proyectos.

- **Nombre del Proyecto:** Dimension o parte de la soluci√≥n del problema general

En el presente aplicativo nombraremos al proyecto y a la soluci√≥n como ‚ÄúHelloWorld‚Äù dado que no hay mucha complejidad y solamente tendremos un proyecto. En posteriores aplicaciones crearemos proyectos m√°s complejos y sera necesario manejar mejor esta nomenclatura.

Otro tema importante de ver al momento de crear nuestro aplicativo es tener en cuenta la version de .NET Framework. La elecci√≥n de la version depender√° en la versi√≥n de Revit.

```
| Version Revit | .NET Framework |
| ------------- | -------------- |
| 2016          | Versi√≥n 4.5    |
| 2017          | Versi√≥n 4.5.2  |
| 2018          | Versi√≥n 4.6.2  |
| 2019          | Versi√≥n 4.7    |
| 2020          | Versi√≥n 4.7.2  |
| 2021          | Versi√≥n 4.8    |
```

Usaremos el .NET Framework 4.7.2 para aplicarlo en el Revit 2020.

![3.jpg](/images/posts/mi-primer-addin/3.jpg)

[Visual Studio](https://visualstudio.microsoft.com/es/) es uno de los mejores IDE que existen en el mercado dado que te facilitan notablemente el trabajo que realizamos. Si seguimos paso a paso las configuraciones del procedimiento anterior llegaremos hasta este punto.

![4.2.jpg](/images/posts/mi-primer-addin/4.jpg)

Procederemos a renombrar el nombre de la clase ‚ÄúClass1.cs‚Äù por ‚ÄúCmdHelloWorld‚Äù. Una buena practica personal es nombrar al inicio de cada comando con la palabra ‚ÄúCmd‚Äù para hacer m√°s r√°pido la identificaciones entre las clases que creemos

![5.jpg](/images/posts/mi-primer-addin/5.jpg)

![6.jpg](/images/posts/mi-primer-addin/6.jpg)

Agregaremos las referencias (.dll) de las librer√≠as de Revit que nos permitir√° interactuar con los m√©todos y propiedades de Autodesk Revit. Para este peque√±o aplicativo solo agregaremos ‚ÄúRevitAPI‚Äù y ‚ÄúRevitAPIUI‚Äù que la podremos encontrar en la ruta ‚ÄúC:\Program Files\Autodesk\Revit 20XX‚Äù

![7.jpg](/images/posts/mi-primer-addin/7.jpg)

Una vez agregadas las referencias, seleccionamos ambos ‚ÄúRevitAPI‚Äù y ‚ÄúRevitAPIUI‚Äù y en sus propiedades cambiamos el campo de ‚ÄúCopia local‚Äù a ‚ÄúFalse‚Äù, esto por el siguiente motivo.

Visual Studio no sabe de que estamos trabajando un aplicativo para Revit, entonces la copia local significa que va a copiar localmente todos los archivos relacionados con la API de Revit, pero como en este caso crearemos un aplicativo que va a funcionar dentro del entorno de la API de Revit no es necesario volver a copiar las librerias porque ya los tiene internamente.

![8.jpg](/images/posts/mi-primer-addin/8.jpg)

Ahora agregaremos los namespace necesarios a Visul Studio los cuales contienen clases, m√©todos y propiedades de Revit.

![9.jpg](/images/posts/mi-primer-addin/9.jpg)

Podemos encontrar todos los namespace de Revit en el siguiente [link:](https://www.revitapidocs.com/2020/)

Luego debemos crear un IExternalCommand(Comando externo) para eso implementaremos una interfaz de la cual se hereda propiedades y m√©todos, esto lo creamos con el fin de tener una estructura definida, para este caso Revit necesita una estructura denominada [Execute](https://www.revitapidocs.com/2022/ab42c8d3-d361-88d2-5043-2d427d1238fc.htm).

![10.jpg](/images/posts/mi-primer-addin/10.jpg)

Ya con la estructura implementada procederemos a devolver un resultado del aplicativo, para eso borramos el texto ‚Äúthrow new NotImplementedException()‚Äù.

![11.jpg](/images/posts/mi-primer-addin/11.jpg)

Visual Studio nos muestra un error porque nosotros estamos creando un m√©todo que devuelva un resultado pero aun no hemos escrito el resultado, para eso ingresaremos el siguiente c√≥digo.

![12.jpg](/images/posts/mi-primer-addin/12.jpg)

Y procedemos a escribir lo siguiente.

```csharp
return Result.Succeeded;
```

lo cual indica que el resultado que estamos devolviendo es exitoso.

**Nota:** Tener en cuenta que cuando escribimos un c√≥digo siempre termina con punto y coma (;).

![13.jpg](/images/posts/mi-primer-addin/13.jpg)

Luego crearemos un [TaskDialog](https://www.revitapidocs.com/2022/5aaa0247-7707-7508-4973-009b01669297.htm) el cual es un m√©todo que tiene dos entradas un ‚Äútitulo‚Äù y una ‚Äúdescripci√≥n‚Äù, para eso escribiremos el siguiente c√≥digo.

```csharp
TaskDialog.Show("Mi primer aplicativo", "Hola Mundo");
```

![14.jpg](/images/posts/mi-primer-addin/14.jpg)

Ahora faltaria a√±adir el transaction que va entre corchetes [ ], el cual nos permitira comunicarnos con toda la base de datos de Revit, encontraremos dos tipos:

```
| TransactionMode | Descripci√≥n                          |
| --------------- | ------------------------------------ |
| ReadOnly:       | Solo modo de lectura.                |
| Manual:         | Te permite realizar cambios a Revit. |
```

![15.jpg](/images/posts/mi-primer-addin/15.jpg)

Luego crearemos el archivo manifiesto el cual es indispensable para generar el vinculo entre la (.dll) que estamos creando y Revit.

![17.jpg](/images/posts/mi-primer-addin/17.jpg)

![16.jpg](/images/posts/mi-primer-addin/16.jpg)

Luego ingresamos al siguiente [Link](https://gist.github.com/riverscode/e5c8e4a3446bd6e3fb142a42b8dfe6ff) donde encontraremos una porci√≥n del codigo que va en el archivo manifiesto.

```csharp
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<RevitAddIns>
  <AddIn Type="Command">
    <Assembly>HelloWorld.dll</Assembly>
    <AddInId>ecb76306-3561-43f3-adc7-01d1a178e74e</AddInId>
    <FullClassName>HelloWorld.CmdHelloWorld</FullClassName>
    <Text>Hola Mundo</Text>
    <VendorId>ADSK</VendorId>
    <VendorDescription>Lambda Ingenieria e Innovacion, https://lambda.com.pe</VendorDescription>
    <VisibilityMode>NotVisibleInFamily</VisibilityMode>
    <Discipline>Any</Discipline>
  </AddIn>
</RevitAddIns>
```

```
| Campos            | Descripci√≥n                                                                                                                                                       |
| ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| AddIn Type        | Tipo de aplicativo que podria ser ‚ÄúCommand‚Äù o ‚ÄúAplication‚Äù                                                                                                        |
| Assembly          | Es la ruta donde esta el aplicativo (.dll).                                                                                                                       |
| AddInId           | Es el Guid, es una codificaci√≥n de microsoft para identificar sus documentos, archivos, elementos en general; esto podemos generarlo a partir del siguiente link. |
| FullClassName     | Es la clase donde esta el m√©todo execute.                                                                                                                         |
| Text              | Es el nombre como se va a mostrar dentro del aplicativo.                                                                                                          |
| VendorId          | Puede ser cualquier texto.                                                                                                                                        |
| VendorDescription | Una descripci√≥n del aplicativo, para que sirve.                                                                                                                   |
| VisibilityMode    | NotVisibleInFamily: Que no se aplicara dicho applicativo en una familia.                                                                                          |
| Discipline        | Disciplina seg√∫n la especialidad en que se trabajara (Arquitectura, Estructura, Electrica, Mecanicas, Etc).                                                       |
```

Luego agregaremos a Visual Studio los eventos de compilaci√≥n, los cuales despues de compilar un addin dentro de Revit. Permite compilar los archivos .dll y .addin dentro de una caperta que Revit leera el manifiesto y podra cargar nuestro addin, podemos encontrar estos eventos en el siguiente [link](https://gist.github.com/riverscode/66b6acac8cd453ad8dac6e553fce9f56).

```csharp
copy "$(ProjectDir)*.addin" "$(AppData)\Autodesk\REVIT\Addins\2020"
copy "$(ProjectDir)bin\debug\*.dll" "$(AppData)\Autodesk\REVIT\Addins\2020"
```

![19.jpg](/images/posts/mi-primer-addin/19.jpg)

![20.jpg](/images/posts/mi-primer-addin/20.jpg)

Como √∫ltimo paso, despues ingresar estos eventos procedemos a compilar el aplicativo, el cual nos dara como resultado que el aplicativo se compilo dentro de Revit.

![21.jpg](/images/posts/mi-primer-addin/21.jpg)

Abrimos Revit 2020 y nos saldra una notificaci√≥n indicando que se ingresera un aplicativo a Revit donde debemos seleccionar la opci√≥n ‚ÄúCargar siempre‚Äù.

![22.jpg](/images/posts/mi-primer-addin/22.jpg)

Una vez realizado eso abrimos un proyecto de ejemplo en Revit, nos vamos a la pesta√±a de complementos/Herramientas externas/Hola Mundo.

![23jpg.jpg](/images/posts/mi-primer-addin/23.jpg)

Como producto final vemos el mensaje que nos muestra nuestro primer aplicativo.

![24jpg.jpg](/images/posts/mi-primer-addin/24.jpg)

Y eso es todo. Es un proceso corto pero vale la pena intentarlo y probarlo, sumemonos todos para poder formar una comunidad de personas que tengan las ganas de ingresar a este nuevo mundo de la programaci√≥n.

Para m√°s contenido suscr√≠banse al canal y comp√°rtanlo para que este tipo de contenido llegue a m√°s personas.

Si necesitan m√°s informaci√≥n sobre este incre√≠ble mundo de la automatizaci√≥n de procesos a trav√©s de la creaci√≥n de aplicaciones en Autodesk Revit no duden en escribirme a mi LinkedIn [Bryan Espinoza Allcca](https://www.linkedin.com/in/bryan-espinoza-bim/) o dejar comentarios debajo de este post.
